# 协议规范文档

**版本名称：** v1.0.0

**版本代号：** 10000

---

# 定义

**索引位置：** 事件和索引文件在服务器上的根目录，如：

```text
https://example.com/events/
```

**事件消息：** 由标题、图标、链接、描述、内容等信息构成的一段 JSON 格式数据。

---

# 规范

> 下面列出的文件均存储在“索引位置”中。

#### index.json

该文件存储此“事件索引服务”的“名称”、“简介”，“协议版本”等数据。

以下为一个完整的标准示例：

```json
{
    "info": {
        "name": "Event Index Server",      // 事件索引服务器的名称
        "desc": "Hello, World! "           // 事件索引服务器的简介描述
    },
    "protocol": {
        "version": {
            "name": "1.0.0",               // 版本名称，用于展示给用户，不参与版本号判断
            "code": 10000,                 // 主版本标识，参与协议的版本号判断
            "update": 0                    // 子版本标识，参与协议的版本号判断（应先判断主版本标识）
        }
    }
}
```

#### counter.json

该文件存储上一个“事件消息”的ID和对应的发布时间。

> 应用程序可在其本地储存一份 Counter 文件，以便判断服务器有哪些新发布且未被获取的事件消息。

**客户端可通过轮询该文件快速判断服务器上是否存在新的事件消息，而不必轮询 Index 和 Data 文件。**

*此文件用户客户端轮询。*

以下为一个完整的标准示例：

```json
{
    "last": 1000,                          // 事件消息ID
    "time": 1300000000000                  // 13位时间戳
}
```

#### data.json

该文件存储每一个事件消息的ID和其部分的元数据。

> 客户端可通过读取该文件快速筛选“类型”、“标签”、“分类”，而不必逐个获取完整的事件消息文件。

以下为一个完整的标准示例：

```json
{
    "index": [                             // 此处为 JSON 数组，所有的事件消息应当按照特定顺序在此列出
        {
            "id": 1000,                    // 事件消息ID（以下元数据应当和事件消息文件中的值一致）
            "hide": false,                 // 是否隐藏，如此值为 true ，客户端应当忽略该消息（无论标签分类是否匹配）
            "classes": {
                "type": [                  // 类型：用于区分指定消息（如“用户可读”，“程序可读”等），本协议不做规定；此处仅作示例；允许一条事件消息存在多个类型
                    "normal"               // （仅示例，无规定）
                ],
                "categories": [            // 分类：用于详细区分指定消息，本协议不做规定；此处仅作示例；允许一条事件消息存在多个分类
                    "system"               // （仅示例，无规定）
                ],
                "tags": [                  // 标签：用于详细区分指定消息，本协议不做规定；此处仅作示例；允许一条事件消息存在多个标签
                    "test"                 // （仅示例，无规定）
                ]
            },
            "time": 1300000000000          // 事件消息发布时间
        }
    ]
}
```
